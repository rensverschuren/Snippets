<h1>Reserveren</h1><h2>Komende reserveringen</h2><table cellpadding="5" width="100%" border="1" id="tabelreserv">  <tr valign="top" bgcolor="#8599CF" style="color: white; border: 0px;">  	<td><b>Datum</b></td>    <td><b>Naam</b></td>        <td><b>Van</b></td>    <td><b>Tot</b></td>        <td><b>Apparatuur</b></td>    <td>&nbsp;</td>    <td>&nbsp;</td>  </tr><?php$query = "SELECT	reserveringen.id AS rid,	reserveringen.opmerkingen AS opmerk,    	date_format(reserveringen.begintijd, '%H:%i') AS begint,		date_format(reserveringen.begintijd, '%d-%m-%Y') AS dat,	date_format(reserveringen.eindtijd, '%H:%i') AS eindt,		gebruikers.id AS gid,		gebruikers.voornaam AS vrnaam,	gebruikers.tussenvoegsel AS tsnvoegsl,	gebruikers.achternaam AS achtrnaam	FROM	reserveringenINNER JOIN	gebruikersON	gebruikers.id = reserveringen.gebruikerWHERE	reserveringen.eindtijd > NOW()ORDER BY	reserveringen.begintijd ASC LIMIT 0,10";	$resultaat = mysql_query($query) or die (mysql_error());$aantal = mysql_num_rows($resultaat);if($aantal == 0) {	echo "<p>Er is nog geen apparatuur gereserveerd.</p>";}else {	while($obj = mysql_fetch_assoc($resultaat)) {		echo "<tr valign=\"top\" style=\"border: 1px dashed #cccccc;\">";		echo "<td>".$obj['dat']."</td>";    	if(empty($obj['tsnvoegsl'])) {			echo "<td><a href=\"index.php?pagina=gebruiker&amp;id=".$obj['gid']."\">".$obj['vrnaam']." ".$obj['achtrnaam']."</a></td>";		}		else {			echo "<td><a href=\"index.php?pagina=gebruiker&amp;id=".$obj['gid']."\">".$obj['vrnaam']." ".$obj['tsnvoegsl']." ".$obj['achtrnaam']."</a></td>";		}         	echo "<td>".$obj['begint']."</td>";    	echo "<td>".$obj['eindt']."</td>";       	 		$query1 = "		SELECT 			reserveren.object AS objt		FROM			reserveren		INNER JOIN			reservapp		ON			reservapp.apparaat = reserveren.id		WHERE 			reservapp.reservering = ".$obj['rid']."";				$resultaat1 = mysql_query($query1) or die (mysql_error());			echo "<td>";				while($obj1 = mysql_fetch_assoc($resultaat1)) {					echo "- ".$obj1['objt']."<br />";				}				echo "</td>";				//opmerkingen met popup		if(!empty($obj['opmerk'])) {			echo "<td valign=\"middle\" align=\"center\"><a href=\"#\" id=\"a1\"><img src=\"afbeeldingen/info.png\" border=\"0\" /></a></td>";		}			else {			echo "<td>&nbsp;</td>";		}					echo "<td valign=\"middle\" align=\"center\" >";				//reservering verwijderen laten zien		if($obj['gid'] == $_SESSION['gebruiker'] || rechten(3)) {			echo "<a href=\"index.php?pagina=verwijderreservering&amp;id=".$obj['rid']."\" onclick=\"return confirm('Weet je zeker dat je deze reservering wilt verwijderen?')\"><img src=\"afbeeldingen/error.png\" border=\"0px\" title=\"Reservering verwijderen\" /></a>";   					}		else {			echo "&nbsp;";		}		echo "</td>";		echo "</tr>";			}	echo "</table>";}echo "<div id=\"note1\">Opmerking:</div>";?><h2>Apparatuur reserveren</h2><?phpif(isset($_POST['submit'])) { //als er op de knop is gedrukt...		$voltooid = true;		echo "<ul>";		//controleren of er op die datum nog niks is gereserveerd	$datum = $_POST['jaar']."-".$_POST['maand']."-".$_POST['dag'];	$begintijd = $datum." ".$_POST['uurbegin'].":".$_POST['minuutbegin'].":00";	$eindtijd = $datum." ".$_POST['uureind'].":".$_POST['minuuteind'].":00";		$query = "SELECT id FROM reserveringen WHERE '".$begintijd."' BETWEEN begintijd AND eindtijd OR '".$eindtijd."' BETWEEN begintijd AND eindtijd";	$resultaat = mysql_query($query) or die (mysql_error());		$aantal = mysql_num_rows($resultaat);		if($aantal != 0) {		//kijken hoeveel apparaten er gereserveerd kunnen worden, dus ook hoeveel checkboxes		$query1 = "SELECT id FROM reserveren";		$resultaat1 = mysql_query($query1) or die (mysql_error());			$aantalapp = mysql_num_rows($resultaat1);					for($i = 0; $i <= $aantalapp; $i++) {				if(isset($_POST[$i])) {				$query2 = "SELECT id FROM reservapp WHERE apparaat = ".$i."";				$resultaat2 = mysql_query($query2) or die (mysql_error());					$aantalreserv = mysql_num_rows($resultaat2);				if($aantalreserv != 0) {					//hoe heet het object dat al gereserveerd is?					$query3 = "SELECT object FROM reserveren WHERE id = ".$i."";					$resultaat3 = mysql_query($query3) or die (mysql_error());						while($obj3 = mysql_fetch_assoc($resultaat3)) {						echo "<li class=\"fout\">".$obj3['object']." is al gereserveerd op dit tijdstip.</li>";						$voltooid = false;					}				}			}		}		}			//kijken of er een van de checkboxes is ingevuld	$query1 = "SELECT id FROM reserveren";	$resultaat1 = mysql_query($query1) or die (mysql_error());		$aantalapp = mysql_num_rows($resultaat1);			$waarde = true;		for($i = 0; $i <= $aantalapp; $i++) {			if(empty($_POST[''.$i.''])) {			$waarde = false;		}		else {			$waarde = true;			break;		}	}		if(!$waarde) {		echo "<li class=\"fout\">Je dient een van de apparaten aan te vinken die je wilt reserveren.</li>";		$voltooid = false;	}			if($begintijd == $eindtijd) {		echo "<li class=\"fout\">De eindtijd mag niet hetzelfde zijn als de begintijd.</li>";		$voltooid = false;	}		//kijken of er in het verleden wordt gereserveerd	$vandaag = strtotime(date("j-n-Y"));	$gewenst = strtotime($_POST['dag']."-".$_POST['maand']."-".$_POST['jaar']);	if($gewenst < $vandaag) {		 echo "<li class=\"fout\">Je kunt niet reserveren voor een dag die al voorbij is.</li>";		 $voltooid = false;	}			echo "</ul>";		if($voltooid) {				$datum = $_POST['jaar']."-".$_POST['maand']."-".$_POST['dag'];		$begintijd = $datum." ".$_POST['uurbegin'].":".$_POST['minuutbegin'].":00";		$eindtijd = $datum." ".$_POST['uureind'].":".$_POST['minuuteind'].":00";				$query2 = "INSERT INTO reserveringen (gebruiker, opmerkingen, begintijd, eindtijd, gereserveerd) VALUES (".$_SESSION['gebruiker'].",'".$_POST['opmerkingen']."','".$begintijd."','".$eindtijd."',NOW())";		mysql_query($query2) or die (mysql_error());				$idlaatst = mysql_insert_id();			$query1 = "SELECT id FROM reserveren";		$resultaat1 = mysql_query($query1) or die (mysql_error());				while($obj1 = mysql_fetch_assoc($resultaat1)) {			if(isset($_POST[''.$obj1['id'].''])) {							$query1 = "INSERT INTO reservapp (reservering, apparaat) VALUES (".$idlaatst.",".$obj1['id'].")";				mysql_query($query1) or die (mysql_error());			}		}		header("location: index.php?pagina=reserverensucces");	}}?><form action="index.php?pagina=reserveren" method="post"><table>  <tr>    <td width="145">Datum</td>    <td>    <select name="dag"> 	<option value="01" selected="selected">1</option>	<option value="02">2</option>	<option value="03">3</option>	<option value="04">4</option>	<option value="05">5</option>	<option value="06">6</option>	<option value="07">7</option>	<option value="08">8</option>	<option value="09">9</option>	<option value="10">10</option>	<option value="11">11</option>	<option value="12">12</option>	<option value="13">13</option>	<option value="14">14</option>	<option value="15">15</option>	<option value="16">16</option>	<option value="17">17</option>	<option value="18">18</option>	<option value="19">19</option>	<option value="20">20</option>	<option value="21">21</option>	<option value="22">22</option>	<option value="23">23</option>	<option value="24">24</option>	<option value="25">25</option>	<option value="26">26</option>	<option value="27">27</option>	<option value="28">28</option>	<option value="29">29</option>	<option value="30">30</option>	<option value="31">31</option>	</select>    <select name="maand"> 	<option value="01" selected="selected">Januari</option>	<option value="02">Februari</option>	<option value="03">Maart</option>	<option value="04">April</option>	<option value="05">Mei</option>	<option value="06">Juni</option>	<option value="07">Juli</option>	<option value="08">Augustus</option>	<option value="09">September</option>	<option value="10">Oktober</option>	<option value="11">November</option>	<option value="12">December</option>	</select>    	<select name="jaar"> 		<?php	for($i = date("Y"); $i <= date("Y") + 2; $i++) {		echo "<option value=\"".$i."\">".$i."</option>";	}	?>    </select>    </td>  </tr>  <tr>    <td>Benodigde appraratuur</td>    <td>    <?php	include("includes/db_connect.php");	$query = "SELECT id, object FROM reserveren ORDER BY object";	$resultaat = mysql_query($query) or die (mysql_error());	while($obj = mysql_fetch_assoc($resultaat)) {		echo "<label><input name=\"".$obj['id']."\" type=\"checkbox\" value=\"waar\">".$obj['object']."</label><br />";	}	?>    </td>  </tr>  <tr>  <td>Tijden</td>  <td>  Begintijd:&nbsp;  <select name="uurbegin">     <option value="00" selected="selected">00</option>  	<option value="01">01</option>		<option value="02">02</option>	<option value="03">03</option>	<option value="04">04</option>	<option value="05">05</option>	<option value="06">06</option>	<option value="07">07</option>	<option value="08">08</option>	<option value="09">09</option>	<option value="10">10</option>	<option value="11">11</option>	<option value="12">12</option>	<option value="13">13</option>	<option value="14">14</option>	<option value="15">15</option>	<option value="16">16</option>	<option value="17">17</option>	<option value="18">18</option>	<option value="19">19</option>	<option value="20">20</option>	<option value="21">21</option>	<option value="22">22</option>	<option value="23">23</option>		</select>     :     <select name="minuutbegin">     <option value="00" selected="selected">00</option>	<option value="01">01</option>	<option value="02">02</option>	<option value="03">03</option>	<option value="04">04</option>	<option value="05">05</option>	<option value="06">06</option>	<option value="07">07</option>	<option value="08">08</option>	<option value="09">09</option>	<option value="10">10</option>	<option value="11">11</option>	<option value="12">12</option>	<option value="13">13</option>	<option value="14">14</option>	<option value="15">15</option>	<option value="16">16</option>	<option value="17">17</option>	<option value="18">18</option>	<option value="19">19</option>	<option value="20">20</option>	<option value="21">21</option>	<option value="22">22</option>	<option value="23">23</option>    <option value="23">24</option>	    <option value="23">25</option>	    <option value="23">26</option>	    <option value="23">27</option>	    <option value="23">28</option>	    <option value="23">29</option>	    <option value="23">30</option>	    <option value="23">31</option>	    <option value="23">32</option>	    <option value="23">33</option>	    <option value="23">34</option>	    <option value="23">35</option>	    <option value="23">36</option>	    <option value="23">37</option>	    <option value="23">38</option>	    <option value="23">39</option>	    <option value="23">40</option>	    <option value="23">41</option>	    <option value="23">42</option>	    <option value="23">43</option>	    <option value="23">44</option>	    <option value="23">45</option>	    <option value="23">46</option>	    <option value="23">47</option>	    <option value="23">48</option>	    <option value="23">49</option>	    <option value="23">50</option>	    <option value="23">51</option>	    <option value="23">52</option>	    <option value="23">53</option>	    <option value="23">54</option>	    <option value="23">55</option>	    <option value="23">56</option>	    <option value="23">57</option>	    <option value="23">58</option>	    <option value="23">59</option>		</select>  <br />    Eindtijd:       &nbsp;&nbsp;  <select name="uureind"> 	<option value="00" selected="selected">00</option>    <option value="01">01</option>	<option value="02">02</option>	<option value="03">03</option>	<option value="04">04</option>	<option value="05">05</option>	<option value="06">06</option>	<option value="07">07</option>	<option value="08">08</option>	<option value="09">09</option>	<option value="10">10</option>	<option value="11">11</option>	<option value="12">12</option>	<option value="13">13</option>	<option value="14">14</option>	<option value="15">15</option>	<option value="16">16</option>	<option value="17">17</option>	<option value="18">18</option>	<option value="19">19</option>	<option value="20">20</option>	<option value="21">21</option>	<option value="22">22</option>	<option value="23">23</option>		</select>     :     <select name="minuuteind">     <option value="00" selected="selected">00</option>	<option value="01">01</option>	<option value="02">02</option>	<option value="03">03</option>	<option value="04">04</option>	<option value="05">05</option>	<option value="06">06</option>	<option value="07">07</option>	<option value="08">08</option>	<option value="09">09</option>	<option value="10">10</option>	<option value="11">11</option>	<option value="12">12</option>	<option value="13">13</option>	<option value="14">14</option>	<option value="15">15</option>	<option value="16">16</option>	<option value="17">17</option>	<option value="18">18</option>	<option value="19">19</option>	<option value="20">20</option>	<option value="21">21</option>	<option value="22">22</option>	<option value="23">23</option>    <option value="23">24</option>	    <option value="23">25</option>	    <option value="23">26</option>	    <option value="23">27</option>	    <option value="23">28</option>	    <option value="23">29</option>	    <option value="23">30</option>	    <option value="23">31</option>	    <option value="23">32</option>	    <option value="23">33</option>	    <option value="23">34</option>	    <option value="23">35</option>	    <option value="23">36</option>	    <option value="23">37</option>	    <option value="23">38</option>	    <option value="23">39</option>	    <option value="23">40</option>	    <option value="23">41</option>	    <option value="23">42</option>	    <option value="23">43</option>	    <option value="23">44</option>	    <option value="23">45</option>	    <option value="23">46</option>	    <option value="23">47</option>	    <option value="23">48</option>	    <option value="23">49</option>	    <option value="23">50</option>	    <option value="23">51</option>	    <option value="23">52</option>	    <option value="23">53</option>	    <option value="23">54</option>	    <option value="23">55</option>	    <option value="23">56</option>	    <option value="23">57</option>	    <option value="23">58</option>	    <option value="23">59</option>		</select>    </td>  </tr>  <tr>  <td>Eventuele opmerkingen</td>  <td><textarea name="opmerkingen" cols="30" rows="10"></textarea></td>  </tr>   </table><p><input name="submit" type="submit" value="Reserveer apparatuur"></p></form>